CodeMirror.tagRangeFinder=function(e,n,r){for(var i=new RegExp("^[A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*"),t=e.getLine(n),u=!1,a=null,f=0;!u;){if(-1==(f=t.indexOf("<",f)))return;if(f+1<t.length&&"/"==t[f+1])f++;else if(t.substr(f+1).match(i)){var o=t.indexOf(">",f+1);if(-1==o){for(var l=n+1,F=!1,s=e.lineCount();l<s&&!F;){var d=e.getLine(l),v=d.indexOf(">");if(-1!=v){F=!0;var g=d.lastIndexOf("/",v);if(-1!=g&&g<v&&!(h=t.substr(g,v-g+1)).match(/\/\s*\>/))return!0===r&&l++,l}l++}u=!0}else{var c=t.lastIndexOf("/",o);if(-1==c)u=!0;else{var h=t.substr(c,o-c+1);h.match(/\/\s*\>/)||(u=!0)}}u&&((a=t.substr(f+1).match(i))?(a=a[0],-1!=t.indexOf("</"+a+">",f)&&(u=!1)):u=!1),u||f++}else f++}if(u)for(var D="(\\<\\/"+a+"\\>)|(\\<"+a+"\\>)|(\\<"+a+"\\s)|(\\<"+a+"$)",C=new RegExp(D,"g"),x="</"+a+">",b=1,l=n+1,s=e.lineCount();l<s;){var p=(t=e.getLine(l)).match(C);if(p)for(var O=0;O<p.length;O++)if(p[O]==x?b--:b++,!b)return!0===r&&l++,l;l++}},CodeMirror.braceRangeFinder=function(e,n,r){for(var i,t,u=e.getLine(n),a=u.length;;){var f=u.lastIndexOf("{",a);if(f<0)break;if(t=e.getTokenAt({line:n,ch:f}).className,!/^(comment|string)/.test(t)){i=f;break}a=f-1}if(!(null==i||u.lastIndexOf("}")>i)){var o,l=1,F=e.lineCount();e:for(var s=n+1;s<F;++s)for(var d=e.getLine(s),v=0;;){var g=d.indexOf("{",v),c=d.indexOf("}",v);if(g<0&&(g=d.length),c<0&&(c=d.length),(v=Math.min(g,c))==d.length)break;if(e.getTokenAt({line:s,ch:v+1}).className==t)if(v==g)++l;else if(!--l){o=s;break e}++v}if(null!=o&&o!=n+1)return!0===r&&o++,o}},CodeMirror.indentRangeFinder=function(e,n){for(var r,i=e.getOption("tabSize"),t=e.getLineHandle(n).indentation(i),u=n+1,a=e.lineCount();u<a;++u){var f=e.getLineHandle(u);if(!/^\s*$/.test(f.text)){if(f.indentation(i)<=t)break;r=u}}return r?r+1:null},CodeMirror.newFoldFunction=function(e,n,r){function i(e,n){for(var r=0;r<u.length;++r){var i=e.lineInfo(u[r].start);if(i){if(i.line==n)return{pos:r,region:u[r]}}else u.splice(r--,1)}}function t(e,n){e.clearMarker(n.start);for(var r=0;r<n.hidden.length;++r)e.showLine(n.hidden[r])}var u=[];return null==n&&(n='<div style="position: absolute; left: 2px; color:#600">&#x25bc;</div>%N%'),function(a,f){a.operation(function(){var o=i(a,f);if(o)u.splice(o.pos,1),t(a,o.region);else{var l=e(a,f,r);if(null==l)return;for(var F=[],s=f+1;s<l;++s){var d=a.hideLine(s);d&&F.push(d)}var v=a.setMarker(f,n),g={start:v,hidden:F};a.onDeleteLine(v,function(){t(a,g)}),u.push(g)}})}};