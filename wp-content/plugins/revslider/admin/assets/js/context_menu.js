var tpLayerContextMenu=new function(){function e(e){var t=0,a=0;if(!e)var e=window.event;return e.pageX||e.pageY?(t=e.pageX,a=e.pageY):(e.clientX||e.clientY)&&(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:t,y:a}}function t(){a(),r(),s(),l()}function a(){document.addEventListener("contextmenu",function(e){p=w.clickInsideElement(e,"slide_layer"),jQuery(p).hasClass("demo_layer")||(p?(w.setLayerSelected(jQuery(p).data("serial")),e.preventDefault(),L.toggleMenuOn("layer"),u(e)):(p=w.clickInsideElement(e,"bg_context_listener"))?(e.preventDefault(),L.toggleMenuOn("background"),u(e)):(p=w.clickInsideElement(e,"ignorecontextmenu"))?(e.preventDefault(),L.toggleMenuOn(),u(e)):(p=null,L.toggleMenuOff()))})}function r(){jQuery("body").on("click",function(e){var t=w.clickInsideElement(e,V);t?(e.preventDefault(),m(t)):1===(e.which||e.button)&&L.toggleMenuOff()})}function s(){window.onkeyup=function(e){27===e.keyCode&&L.toggleMenuOff()}}function l(){window.onresize=function(e){L.toggleMenuOff()}}function o(e){var t="rs-icon-layerimage_n";switch(e){case"image":t="rs-icon-layerimage_n";break;case"text":t="rs-icon-layerfont_n";break;case"button":t="rs-icon-layerbutton_n";break;case"audio":t="rs-icon-layeraudio_n";break;case"video":t="rs-icon-layervideo_n";break;case"svg":t="rs-icon-layersvg_n";break;case"row":t="rs-icon-layergroup_n";break;case"column":t="rs-icon-layercolumn_n";break;case"group":t="rs-icon-layergroup_n"}return t}function c(e,t){e?jQuery(t).removeClass("ctx-td-s-off"):jQuery(t).addClass("ctx-td-s-off")}function n(){jQuery(".not_in_ctx_bg").hide(),jQuery(".not_in_ctx_layer").show();var e=jQuery("#ctx_list_of_layers");e.html("");for(i in w.arrLayers){var t=w.arrLayers[i],a=o(t.type);e.append('<li class="ctx-dyn-avl-list-item context-menu__item" data-serial="'+t.serial+'"><div class="ctx_item_inner"><div class="context-menu__link" data-serial="'+t.serial+'" data-action="selectonelayer"><i class="'+a+'"></i><span class="cx-layer-name">'+t.alias+"</span></div></div></li>")}}function d(){var e=w.getLayer(w.selectedLayerSerial),t=e.references.htmlLayer;jQuery(".not_in_ctx_bg").show(),jQuery(".not_in_ctx_layer").hide(),jQuery("#cx-selected-layer-name").html(e.alias),jQuery("#cx-selected-layer-icon").attr("class",o(e.type));var a=jQuery("#cx-selected-layer-visible"),r=jQuery("#cx-selected-layer-locked");C.isLayerVisible(t)?(a.find("i").attr("class","eg-icon-eye-off"),a.find(".cx-layer-name").html("Hide Layer")):(a.find("i").attr("class","eg-icon-eye"),a.find(".cx-layer-name").html("Show Layer")),C.isLayerLocked(t)?(r.find("i").attr("class","eg-icon-lock-open"),r.find(".cx-layer-name").html("Unlock Layer")):(r.find("i").attr("class","eg-icon-lock"),r.find(".cx-layer-name").html("Lock Layer"));var s=jQuery("#ctx_list_of_invisibles"),l=jQuery("#ctx_list_of_layers"),i=!0;s.find(".ctx-dyn-inv-list-item").remove(),l.html("");for(m in w.arrLayers){var n=o((t=w.arrLayers[m]).type),d=void 0!==t.references&&void 0!==t.references.htmlLayer?t.references.htmlLayer:void 0;if(void 0!==d&&d.hasClass("currently_not_visible")){var y=i?"ctx-m-top-divider":"";i=!1,s.append('<li class="ctx-dyn-inv-list-item '+y+' context-menu__item"><div class="ctx_item_inner"><div class="context-menu__link" data-serial="'+t.serial+'" data-action="showonelayer"><i class="eg-icon-eye"></i><span class="cx-layer-name">'+t.alias+"</span></div></div></li>")}l.append('<li class="ctx-dyn-avl-list-item context-menu__item" data-serial="'+t.serial+'"><div class="ctx_item_inner"><div class="context-menu__link" data-serial="'+t.serial+'" data-action="selectonelayer"><i class="'+n+'"></i><span class="cx-layer-name">'+t.alias+"</span></div></div></li>")}"grid"===e.basealign?(jQuery("#ctx_gridbased").addClass("selected"),jQuery("#ctx_slidebased").removeClass("selected")):(jQuery("#ctx_gridbased").removeClass("selected"),jQuery("#ctx_slidebased").addClass("selected")),c(e["resize-full"],"#ctx_autoresponsive"),c(e.resizeme,"#ctx_childrenresponsive"),c(e.responsive_offset,"#ctx_responsiveoffset"),c(e["visible-desktop"],"#ctx_showhideondesktop"),c(e["visible-notebook"],"#ctx_showhideonnotebook"),c(e["visible-tablet"],"#ctx_showhideontablet"),c(e["visible-mobile"],"#ctx_showhideonmobile"),c(e.autolinebreak,"#ctx_linebreak"),c(e.scaleProportional,"#ctx_keepaspect"),e.displaymode||"block"===e.display?(jQuery("#ctx_displayblock").addClass("selected"),jQuery("#ctx_displayinline").removeClass("selected")):(jQuery("#ctx_displayblock").removeClass("selected"),jQuery("#ctx_displayinline").addClass("selected")),jQuery("#ctx-list-of-layer-links").data("uniqueid",e.unique_id);for(var u=void 0!==e.groupLink?e.groupLink:0,_=jQuery("#ctx-layer-link-type-element-cs"),m=0;m<6;m++)_.removeClass("ctx-layer-link-type-"+m);_.addClass("ctx-layer-link-type-"+u),jQuery(k).data("current_layer",d);var p="column"===w.getObjLayerType(e.p_uid);switch(k.className="context-menu layer_type_"+e.type+" in_column_"+p,jQuery("#ctx-inheritdesktop").show(),jQuery("#ctx-inheritnotebook").show(),jQuery("#ctx-inherittablet").show(),jQuery("#ctx-inheritmobile").show(),w.getLayout()){case"desktop":jQuery("#ctx-inheritdesktop").hide();break;case"notebook":jQuery("#ctx-inheritnotebook").hide();break;case"tablet":jQuery("#ctx-inherittablet").hide();break;case"mobile":jQuery("#ctx-inheritmobile").hide()}}function y(){}function u(t){b=e(t),h=b.x,f=b.y;var a=jQuery("#viewWrapper").offset(),r=jQuery("#divbgholder").offset(),s=jQuery(window).scrollTop();x=k.offsetWidth+4,v=k.offsetHeight+4,j=window.innerWidth;var l=s+(Q=window.innerHeight),i=15+h-a.left,o=f-(a.top+25);b.x=h-r.left,b.y=f-r.top,i=i+250>j-a.left?j-(260+a.left):i,o=o+300+a.top>l?l-300-a.top:o,k.style.left=i+"px",k.style.top=o+"px",i>j-(a.left+500)?jQuery("#context-menu-first-ul").addClass("submenustoleft"):jQuery("#context-menu-first-ul").removeClass("submenustoleft"),o+300+a.top+200>l?jQuery("#context-menu-first-ul").addClass("submenustobottom"):jQuery("#context-menu-first-ul").removeClass("submenustobottom")}function _(e){return!jQuery(e).hasClass("ctx-td-s-off")}function m(e){var t=!0;if(l={},htmlLayer,updateLayerForm=!1,rebuild=!1,"delegate"!==e.getAttribute("data-action")){switch(e.getAttribute("data-action")){case"delete":jQuery("#button_delete_layer").click();break;case"duplicate":jQuery("#button_duplicate_layer").click();break;case"showhide":jQuery("#layer-short-toolbar .quick-layer-view").click();break;case"lockunlock":jQuery("#layer-short-toolbar .quick-layer-lock").click();break;case"showalllayer":w.showAllLayers();break;case"showonlycurrent":w.hideAllLayers(w.selectedLayerSerial);break;case"showonelayer":var a=w.getLayer(jQuery(e).data("serial"));C.showLayer(a);break;case"selectonelayer":w.setLayerSelected(jQuery(e).data("serial"));break;case"autoresponsive":t=!1,l["resize-full"]=_(e),l["resize-full"]||(l.resizeme=!1,jQuery("#ctx_childrenresponsive").addClass("ctx-td-s-off")),updateLayerForm=!0;break;case"childrenresponsive":t=!1,l.resizeme=_(e),l.resizeme&&(l["resize-full"]=!0,jQuery("#ctx_autoresponsive").removeClass("ctx-td-s-off")),updateLayerForm=!0;break;case"responsiveoffset":t=!1,l.responsive_offset=_(e),updateLayerForm=!0;break;case"gridbased":t=!1,l.basealign="grid",updateLayerForm=!0;break;case"slidebased":t=!1,l.basealign="slide",updateLayerForm=!0;break;case"nothing":t=!1;break;case"linebreak":t=!1,jQuery("#layer_auto_line_break")[0].checked?jQuery("#layer_auto_line_break")[0].checked=!1:jQuery("#layer_auto_line_break")[0].checked=!0,w.clickOnAutoLineBreak();break;case"displayblock":t=!1,l.displaymode=!0,l.display="block",updateLayerForm=!0,htmlLayer=jQuery(k).data("current_layer"),rebuild=!0;break;case"displayinline":t=!1,l.displaymode=!1,l.display="inline-block",updateLayerForm=!0,htmlLayer=jQuery(k).data("current_layer"),rebuild=!0;break;case"advancedcss":jQuery("#advanced-css-layer").click();break;case"resetsize":jQuery("#reset-scale").click();break;case"aspectratio":t=!1,jQuery("#layer_proportional_scale")[0].checked?(jQuery("#layer_proportional_scale")[0].checked=!1,jQuery("#ctx_keepaspect").addClass("ctx-td-s-off")):(jQuery("#layer_proportional_scale")[0].checked=!0,jQuery("#ctx_keepaspect").removeClass("ctx-td-s-off")),l.scaleProportional=jQuery("#layer_proportional_scale")[0].checked,updateLayerForm=!0;break;case"copystyle":t=!1,r=w.getLayer(w.selectedLayerSerial),L.stylecache=jQuery.extend(!0,{},r),UniteAdminRev.showInfo({type:"success",content:"Layer Style Successfull Copied to Clipboard",hidedelay:3});break;case"pastestyle":t=!1,r=w.getLayer(w.selectedLayerSerial),!1===jQuery.isEmptyObject(L.stylecache)?(l.deformation=L.stylecache.deformation,l["deformation-hover"]=L.stylecache["deformation-hover"],l.display=L.stylecache.display,l.displaymode=L.stylecache.displaymode,l.margin=L.stylecache.margin,l.autolinebreak=L.stylecache.autolinebreak,l.padding=L.stylecache.padding,l.whitespace=L.stylecache.whitespace,l.static_styles=L.stylecache.static_styles,l["2d_rotation"]=L.stylecache["2d_rotation"],l["image-size"]=L.stylecache["image-size"],updateLayerForm=!0,htmlLayer=r.references.htmlLayer,rebuild=!0):UniteAdminRev.showInfo({type:"warning",content:"No Style saved to Clipboard",hidedelay:3});break;case"inheritfromdesktop":case"inheritfromnotebook":case"inheritfromtablet":case"inheritfrommobile":var r=w.getLayer(w.selectedLayerSerial),s=e.getAttribute("data-size"),l={};l.static_styles={},l.static_styles.color={},l.static_styles["font-size"]={},l.static_styles["line-height"]={},l.static_styles["font-weight"]={},l.padding={},l.margin={},l.max_height={},l.max_width={},l.scaleX={},l.scaleY={},l["text-align"]={},l.vieo_width={},l.video_height={},l.whitespace={},l.static_styles=w.setVal(l.static_styles,"color",w.getVal(r.static_styles,"color",s),!1),l.static_styles=w.setVal(l.static_styles,"font-size",w.getVal(r.static_styles,"font-size",s),!1),l.static_styles=w.setVal(l.static_styles,"line-height",w.getVal(r.static_styles,"line-height",s),!1),l.static_styles=w.setVal(l.static_styles,"font-weight",w.getVal(r.static_styles,"font-weight",s),!1),l=w.setVal(l,"padding",w.getVal(r,"padding",s),!1),l=w.setVal(l,"margin",w.getVal(r,"margin",s),!1),l=w.setVal(l,"max_height",w.getVal(r,"max_height",s),!1),l=w.setVal(l,"max_width",w.getVal(r,"max_width",s),!1),l=w.setVal(l,"scaleX",w.getVal(r,"scaleX",s),!1),l=w.setVal(l,"scaleY",w.getVal(r,"scaleY",s),!1),l=w.setVal(l,"text-align",w.getVal(r,"text-align",s),!1),l=w.setVal(l,"vieo_width",w.getVal(r,"vieo_width",s),!1),l=w.setVal(l,"video_height",w.getVal(r,"video_height",s),!1),l=w.setVal(l,"whitespace",w.getVal(r,"whitespace",s),!1),updateLayerForm=!0,htmlLayer=r.references.htmlLayer,rebuild=!0;break;case"showhideondesktop":t=!1,l["visible-desktop"]=_(e),updateLayerForm=!0;break;case"showhideonnotebook":t=!1,l["visible-notebook"]=_(e),updateLayerForm=!0;break;case"showhideontablet":t=!1,l["visible-tablet"]=_(e),updateLayerForm=!0;break;case"showhideonmobile":t=!1,l["visible-mobile"]=_(e),updateLayerForm=!0;break;case"grouplinkchange":t=!1,l.groupLink=e.getAttribute("data-linktype");for(var i=(r=w.getLayer(w.selectedLayerSerial)).references.sorttable.layer.find(".layer-link-type-element-cs").first(),o=jQuery("#ctx-layer-link-type-element-cs"),c=0;c<6;c++)i.removeClass("layer-link-type-"+c),o.removeClass("ctx-layer-link-type-"+c);i.addClass("layer-link-type-"+l.groupLink),o.addClass("ctx-layer-link-type-"+l.groupLink);break;case"addtextlayer":w.nextNewLayerToPosition(b),jQuery("#button_add_layer").click();break;case"addimagelayer":w.nextNewLayerToPosition(b),jQuery("#button_add_layer_image").click();break;case"addaudiolayer":w.nextNewLayerToPosition(b),jQuery("#button_add_layer_audio").click();break;case"addvideolayer":w.nextNewLayerToPosition(b),jQuery("#button_add_layer_video").click();break;case"addbuttonlayer":w.nextNewLayerToPosition(b),jQuery("#button_add_layer_button").click();break;case"addshapelayer":w.nextNewLayerToPosition(b),jQuery("#button_add_layer_shape").click();break;case"addobjectlayer":w.nextNewLayerToPosition(b),jQuery("#button_add_layer_svg").click()}!1===jQuery.isEmptyObject(l)&&w.updateLayer(w.selectedLayerSerial,l),updateLayerForm&&w.updateLayerFormFields(w.selectedLayerSerial),rebuild&&C.rebuildLayerIdle(htmlLayer),t&&L.toggleMenuOff()}else jQuery(document.getElementById(e.getAttribute("data-delegate"))).click()}var p,b,h,f,k,g,x,v,j,Q,L=this,w=new Object,C=new Object,V="context-menu__link",S=0;L.stylecache={},L.init=function(){w=UniteLayersRev,C=tpLayerTimelinesRev,k=document.querySelector("#context-menu"),g=k.querySelectorAll(".context-menu__item"),t(),jQuery(".context-submenu").perfectScrollbar({wheelPropagation:!1,suppressScrollX:!0}),jQuery(".context-submenu").each(function(){jQuery(this).on("mouseenter",function(){jQuery(this).perfectScrollbar("update")})}),jQuery("body").on("mouseenter",".ctx-dyn-avl-list-item",function(){jQuery(".layer_due_list_element_selected").removeClass("layer_due_list_element_selected"),jQuery("#slide_layer_"+jQuery(this).data("serial")).addClass("layer_due_list_element_selected")}),jQuery("body").on("mouseleave",".ctx-dyn-avl-list-item",function(){jQuery(".layer_due_list_element_selected").removeClass("layer_due_list_element_selected")}),jQuery("body").on("click",".ctx-td-switcher",function(){jQuery(this).toggleClass("ctx-td-s-off")}),jQuery("body").on("click",".ctx-td-option-selector",function(){var e=jQuery(this);e.parent().find(".selected").removeClass("selected"),e.addClass("selected")})},L.toggleMenuOn=function(e){punchgs.TweenLite.fromTo(k,.2,{x:10,autoAlpha:0},{x:0,autoAlpha:1,display:"block",ease:punchgs.Power2.easeInOut,delay:.2}),1!==S&&(S=1),"layer"===e?-1!=w.selectedLayerSerial?d():y():"background"===e&&n()},L.toggleMenuOff=function(){0!==S&&(S=0,punchgs.TweenLite.to(k,.2,{y:25,autoAlpha:0}))}};