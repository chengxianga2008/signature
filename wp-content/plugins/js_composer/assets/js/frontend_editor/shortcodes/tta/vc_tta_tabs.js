!function(t){window.InlineShortcodeView_vc_tta_tabs=window.InlineShortcodeView_vc_tta_accordion.extend({render:function(){return window.InlineShortcodeView_vc_tta_tabs.__super__.render.call(this),_.bindAll(this,"buildSortableNavigation","updateSortingNavigation"),this.createTabs(),_.defer(this.buildSortableNavigation),this},createTabs:function(){var t=_.sortBy(vc.shortcodes.where({parent_id:this.model.get("id")}),function(t){return t.get("order")});_.each(t,function(t){this.sectionUpdated(t,!0)},this)},defaultSectionTitle:window.i18nLocale.tab,addIcon:function(t,a){var e,i;return"true"===t.getParam("add_icon")&&(e=t.getParam("i_icon_"+t.getParam("i_type")),_.isUndefined(e)||(i='<i class="vc_tta-icon '+e+'"></i>'),"right"===t.getParam("i_position")?a+=i:a=i+a),a},sectionUpdated:function(a,e){var i,n,d,s,o,r,c;if(c=!1,d=a.get("id"),n=this.$el.find(".vc_tta-tabs-container .vc_tta-tabs-list"),i=n.find('[data-vc-target="[data-model-id='+d+']"]'),o=a.getParam("title"),i.length)s='<span class="vc_tta-title-text">'+o+"</span>",s=this.addIcon(a,s),i.html(s);else{var l;s='<span class="vc_tta-title-text">'+o+"</span>",s=this.addIcon(a,s),l=t('<li class="vc_tta-tab" data-vc-target-model-id="'+d+'" data-vc-tab><a href="javascript:;" data-vc-use-cache="false" data-vc-tabs data-vc-target="[data-model-id='+d+']" data-vc-container=".vc_tta">'+s+"</a></li>"),!0!==e&&(r=_.pluck(_.sortBy(vc.shortcodes.where({parent_id:this.model.get("id")}),function(t){return t.get("order")}),"id").indexOf(a.get("id"))-1)>-1&&n.find("[data-vc-tab]:eq("+r+")").length&&(l.insertAfter(n.find("[data-vc-tab]:eq("+r+")")),c=!0),!c&&l.appendTo(n),a.get("isActiveSection")&&l.addClass(this.activeClass)}this.buildPagination()},getNextTab:function(t){var a,e,i;return i=this.$el.find(".vc_tta-tabs-container .vc_tta-tabs-list").children(),a=i.length-1,e=t.index(),e!==a?i.eq(e+1):i.eq(e-1)},removeSection:function(t){var a,e;(a=this.$el.find('.vc_tta-tabs-container .vc_tta-tabs-list [data-vc-target="[data-model-id='+t+']"]').parent()).hasClass(this.activeClass)&&(e=this.getNextTab(a),vc.frame_window.jQuery(e).find("[data-vc-target]").trigger("click")),a.remove(),this.buildPagination()},buildSortableNavigation:function(){this.$el.find(".vc_tta-tabs-container .vc_tta-tabs-list").sortable({items:".vc_tta-tab",forcePlaceholderSize:!0,placeholder:"vc_tta-tab vc_placeholder-tta-tab",helper:this.renderSortingHelper,start:function(t,a){a.placeholder.width(a.item.width())},over:function(t,a){a.placeholder.css({maxWidth:a.placeholder.parent().width()}),a.placeholder.removeClass("vc_hidden-placeholder")},update:this.updateSortingNavigation})},updateSorting:function(t,a){window.InlineShortcodeView_vc_tta_tabs.__super__.updateSorting.call(this,t,a),this.updateTabsPositions(this.getPanelsList())},updateSortingNavigation:function(){var a,e;e=this,(a=this.$el.find(".vc_tta-tabs-list")).find("> .vc_tta-tab").each(function(){var a,i;a=(i=t(this).removeAttr("style")).data("vcTargetModelId"),vc.shortcodes.get(a).save({order:e.getIndex(i)},{silent:!0})}),this.updatePanelsPositions(a)},updateTabsPositions:function(t){var a,e,i;(a=this.$el.find(".vc_tta-tabs-list")).length&&(e=[],i=t.sortable("toArray",{attribute:"data-model-id"}),_.each(i,function(t){e.push(a.find('[data-vc-target-model-id="'+t+'"]'))},this),a.prepend(e)),this.buildPagination()},updatePanelsPositions:function(t){var a,e,i;i=this.getPanelsList(),a=[],e=t.sortable("toArray",{attribute:"data-vc-target-model-id"}),_.each(e,function(t){a.push(i.find('[data-model-id="'+t+'"]'))},this),i.prepend(a),this.buildPagination()},renderSortingHelper:function(t,a){var e,i,n;return e=a,i=a.width()+1,n=a.height(),e.width(i),e.height(n),e},buildPagination:function(){var t;this.removePagination(),t=this.model.get("params"),!_.isUndefined(t.pagination_style)&&t.pagination_style.length&&("top"===t.tab_position?this.$el.find(".vc_tta-panels-container").append(this.getPaginationList()):this.getPaginationList().insertBefore(this.$el.find(".vc_tta-container .vc_tta-panels")))}})}(window.jQuery);